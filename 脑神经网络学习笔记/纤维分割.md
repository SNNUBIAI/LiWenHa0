# 纤维分割

-定义和计算纤维的相似特征，然后采用机器学习算法进行聚类或分类

-研究定义的相似特征从几何特征到解剖特征，再到功能特征，

-新的**描述符(FiberGeoMap)**（*该描述符可以有效地描述纤维的几何特征，包括纤维的形状、位置和方向信息，同时该描述符可以有效地减少个体之间的差异，并且不需要配准步骤*）来表示光纤的几何特征，该描述符可以有效地描述光纤的形状和位置，并且可以输入到我们改进的Transformer编码器网络中，称为**FiberGeoMap学习者**，可以很好地利用光纤的特征。

-在基于神经束的统计分析中便于对脑部疾病的**诊断和随访**，对于了解大脑的结构和功能具有重要意义，如比较疾病组与对照组纤维束的统计差异，或**分析纤维束的结构特征与大脑相应语言相关区域的功能连接之间的关系**。

-首先定义并表示纤维间的相似特征。然后，应用包括当前深度学习方法[3,4,9]在内的各种聚类和分类算法来获得纤维束。

# 算法

-算法的框架包括两部分。首先，分别计算每条光纤的全局和局部**FiberGeoMaps**，然后将这两个**FiberGeoMaps**连接起来作为**FiberGeoMap** **Learner**的输入，以[11,17]中提供的纤维束图谱作为训练集和测试集对其进行训练。

![image-20230921095120224](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20230921095120224.png)

# **FiberGeoMap**

-笛卡尔坐标(x, y, z)转换为标准球面坐标(r， θ， ϕ)(图3(a))，并归一化为[0,1]，最后将(r， θ， ϕ)的值范围分别划分为36个相等的区间，并计算每个光纤流线上体素点落在每个相等区间内的归一化频率。从而得到3个统计直方图，即3*36的二维矢量，记为**FiberGeoMap**。

![image-20230921095406982](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20230921095406982.png)

-**FiberGeoMap**可以有效地帮助识别受试者之间共同的纤维束。

**-FiberGeoMap**能够有效表征光纤的形状、方向和空间分布，从而区分不同的光纤束。

# 算法框架

## -FiberGeoMap Learner![image-20230921095802463](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20230921095802463.png)

-算法选用经典Transform结构和多头自注意的修正。

-我们将**FiberGeoMap∈R3×n**作为输入，其中3是球面轴(r，θ，ϕ)的数量，n是每个球面轴上的bin数量，原始n为36，因为我们将全局和局部**FiberGeoMaps**连接在一起，因此FiberGeoMap数据的大小为3× 72。对于光纤，其**FiberGeoMap**数据包含有关光纤方向和空间分布的信息。与典型的Transformer网络不同的是，首先，我们**只采用了编码器部分**，因为我们对训练数据有标签，不需要解码器来重构输入。其次，由于一根纤维可能有多个标签，例如，CC_1束中的纤维既属于CC_1束，也属于CC束。为了实现**多标签分割**，在最后一层加入了Sigmoid和二值化。第三，在编码器中加入若干dropout层，提高模型的泛化能力。